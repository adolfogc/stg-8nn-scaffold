dist: xenial
sudo: required
language: c

git:
  depth: 1
  quiet: true
  submodules: false

branches:
  only:
    master

cache:
  timeout: 1000
  directories:
    - ${HOME}/.cache/cppcheck
    - ${HOME}/.cache/gcc-arm-none-eabi

before_install:
  - ./scripts/ci/install-cppcheck.sh
  - ./scripts/ci/install-gcc-toolchain.sh
  - git submodule update --init

addons:
  apt:
    update: true
    sources:
      - sourceline: 'deb http://apt.llvm.org/xenial/ llvm-toolchain-xenial-7 main'
        key_url: 'https://apt.llvm.org/llvm-snapshot.gpg.key'
    packages:
      - cmake
      - ninja-build
      - make
      - binutils
      - clang++-7
      - clang-7
      - curl

script:
  - ./ci/scripts/test-cppcheck.sh
  - ./ci/scripts/build-gcc.sh
